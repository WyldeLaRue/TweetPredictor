---
title: "Ain't No Party Like A Political Party"
author: "Lee | Moore | Wylde-Larue"
date: "December 5th 2017"
output: ioslides_presentation
---

## Ignore this
```{r, setup = TRUE, echo = FALSE}
set.seed(1)
library(ggplot2)
library(dplyr)
fivefold <- function(x) {
  x$fold <- c(sample(1:5, size = nrow(x), replace = TRUE))
  MSE <- rep(NA, 5)

  for(j in 1:5) {
    testd <- x %>%
      filter(fold == j)
    
    traind <- x %>%
      filter(fold != j)

    trainmodel <- glm(data = traind , am ~ mpg , family = binomial)
    
    MSE[j] <- mean((testd$am - predict(trainmodel, newdata = testd, type = "response")))
  }
  
  mean(MSE)
}
```


## Introduction

Our research question: Can we predict the political party of a twitter user?        
To this end, we fit a logistic model to classify and make inferences on the political party of politician's twitters.   

## Naive Logistic Regression Model

```{r}
#model that just tosses some predictors in on party
d <- mtcars
d$am <- as.logical(d$am)
m1 <- glm(data = d , am ~ mpg , family = binomial)
#misclassification rate of this model using 5fold CV
fivefold(d)
```

## Visualize

Could visualize a model by doing logit classification and plotting on he first principal component (2D seeable graph)
```{r}
#k encodes tru party
k=0
p1 <- ggplot(d, aes(x=d$mpg, y=d$am, color = as.factor(k))) + geom_point()
p1
p2 <- ggplot(d, aes(x=d$mpg, y=(predict(m1, newdata = d, type = "response")), color = as.factor(k))) + geom_point()
p2
```

## Weaknesses of Previous Model

improvements

## Improved Model

```{r}
# new model

# new predictive capability

```

## Visualize Impoved Model

``{r}
#PCA plotting
means <-kmeans(x = d[,-1], centers = 2, iter.max = 10, nstart = 20)
pca1 <-prcomp(d[,-1])
PC1 <- pca1$x[,1]
PC2 <- pca1$x[,2]
df <-data.frame(PC1, PC2, k = means$cluster)
p1 <-ggplot(df,aes(x=PC1, y=PC2, color =as.factor(k))) + geom_point()
plot(p1)

# Skree plot - is there only 2 parties?
km1 <- kmeans(d[,-1], centers = 1)
km2 <- kmeans(d[,-1], centers = 2)
km3 <- kmeans(d[,-1], centers = 3)
km4 <- kmeans(d[,-1], centers = 4)
km5 <- kmeans(d[,-1], centers = 5)

bub <- data.frame(ClusterNumber = 1:5,
                  tot.within.ss = c(km1$tot.withinss,
                                    km2$tot.withinss,
                                    km3$tot.withinss,
                                    km4$tot.withinss,
                                    km5$tot.withinss
                                    ))
ggplot(bub, aes(x = ClusterNumber, y = tot.within.ss)) +
  geom_line() + 
  geom_point()

# Make GGplots which display parties on the plot
newd <- data.frame(PC1, PC2, k = votemeans$cluster, party = r1$votes$party)

plotvote <- ggplot(newd, aes(x=PC1, y=PC2, color = as.factor(k))) + geom_point() 
plotvote

```

## Outliers & Interesting Things

and what outliers mean
interpretations of data, interpretations of models and coefficients

## Method Continued

To expand upon this research question, "Can you predict the political party of a twitter user using their tweet history," some improvements could be made:

- Training and testing on members of the population to make a model that works more generally, instead of on politicians due to charged language.  
- Considering different interpretations of the data such as quantile-based instead of ratio-based numerics.  
- 
